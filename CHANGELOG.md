# Changelog

## [v1.8.1] - 2026-02-09

### 追加

- SIGINT/SIGTERMシグナルによるグレースフルシャットダウン機能を追加
- 処理中にCtrl+Cで中断した際、子プロセス（AI CLI）も含めて安全に終了するように対応
- コンテキストキャンセル時のテストケースを追加（`TestGenerateCommitMessageContextCanceled`, `TestAIExecutorContextCanceled`）

### 変更

- 全関数に`context.Context`を伝播し、外部コマンド実行を`exec.CommandContext`に統一
- AIExecutorインターフェースの`Execute`メソッドに`context.Context`パラメータを追加

### 削除

- ドキュメント画像`docs/command_image.png`を削除

## [v1.8.0] - 2026-02-09

### 追加

- `-y`/`--yes`フラグによる自動確認コミット機能を追加。AIが生成したコミットメッセージを確認プロンプトなしで即座にコミットできるようになり、CI/CDパイプラインやスクリプトからの非対話的な利用が可能に

## [v1.6.1] - 2026-02-08

### 変更

- golangci-lintをv1（v1.61.0）からv2（v2.8.0）にメジャーアップグレードし、最新のlint規則と高速な解析を利用可能に
- golangci-lint設定ファイル（`.golangci.yaml`）をv2形式に完全移行。`formatters`セクションの分離やexclusion設定の構造化により、設定の可読性と保守性が向上
- CI/CDワークフローのgolangci-lint-actionをv6からv9にアップグレードし、v2系linterとの互換性を確保
- lintタスクの実行優先順位を変更し、ローカルにインストールされたgolangci-lintを最優先で使用するように改善。Docker経由の実行はフォールバックに変更
- 全チェック（テスト・lint・フォーマット）を一括実行する`check-all`タスクを追加し、開発ワークフローを効率化

### 修正

- `_runPreCommit`関数内の変数シャドウイングを解消し、エラーハンドリングの信頼性を向上

## [v1.6.0] - 2026-02-08

### 追加

- AIレスポンスからコミットメッセージを自動抽出する機能を追加。AIが生成した応答テキストから適切なコミットメッセージ部分を識別・抽出することで、より正確なコミットメッセージの生成が可能になりました

## [v1.5.0] - 2026-02-07

### 追加

- コミットメッセージ生成時にファイル一覧と変更統計情報をAIに提供するようになり、より正確で文脈を踏まえたメッセージが生成されるようになりました
- 差分が大きく切り詰められた場合に、ファイル一覧と統計情報から全体像を把握できる注意書きがプロンプトに追加されるようになりました
- 差分の切り詰めに関するテストケースを追加しました

### 変更

- 差分の最大サイズを6,000文字から50,000文字に拡大し、より大きな変更でも正確なコミットメッセージを生成できるようになりました
- `generateCommitMessage`関数のインターフェースを拡張し、ファイル一覧と変更統計を受け取れるようになりました
- テストケースに差分・ファイル一覧・統計情報のフィールドを追加し、テストの網羅性を向上させました

## [v1.4.0] - 2026-01-27

### 変更

- claudeコマンドへのプロンプト渡し方式をコマンドライン引数から標準入力（stdin）に変更
  - 長いプロンプトや特殊文字を含むプロンプトの処理が安定化
  - シェルのエスケープ問題を回避

## [v1.3.4] - 2025-11-07

### 修正

- サブディレクトリからgcautoコマンドを実行した際に、pre-commitフックが正しく動作しない問題を修正しました。リポジトリのルートディレクトリを検出し、ステージングされたファイルを明示的に列挙することで、どのディレクトリからでも一貫して動作するようになりました

## [v1.3.3] - 2025-10-26

### 修正

- pre-commitフックの実行ロジックを改善し、pre-commitコマンドの直接実行に対応しました。従来のGitフック経由の実行に加えて、pre-commitツールがインストールされている場合は`pre-commit run`コマンドを優先的に使用するようになり、より確実にコードチェックが実行されます

## [v1.3.2] - 2025-10-05

### 修正

- ClaudeExecutorの出力から不要なメタデータを除去し、コミットメッセージがクリーンになるよう改善

## [v1.3.1] - 2025-10-04

### 修正

- lintエラーを修正：main_test.goの条件分岐を簡潔化（else-ifパターン適用）
- 変数シャドウイング問題を解消：main.goのエラー処理で適切な変数名を使用

## [v1.3.0] - 2025-10-04

### 変更

- コミットフローを最適化：pre-commitフック → メッセージ生成 → コミットの順序に変更
- pre-commitフックで自動修正されたコードに基づいてコミットメッセージを生成するように改善
- git commitコマンドに--no-verifyフラグを追加し、pre-commitフックの二重実行を防止

## [v1.2.0] - 2025-08-28

### 追加

- miseによるタスク管理のサポート（Makefileを.mise.tomlに置き換え）
- コミットメッセージの編集機能（確認時に`e`オプションで外部エディタ起動）

### 変更

- ビルドシステムをMakefileからmiseベースに移行し、より柔軟なタスク管理を実現
- AIプロンプトをConventional Commits仕様に準拠するよう更新

### 削除

- Makefileを削除（.mise.tomlに完全移行）

## [v1.1.2] - 2025-07-15

### 変更

- CI/CD ワークフローの改善
- README.md のドキュメントを更新

### 修正

- プロンプト表示時の文字化けを修正

## [v1.1.1] - 2025-07-15

### 追加

- コミットメッセージの編集機能 - エディタで生成されたメッセージを編集可能
- バージョン情報のバイナリへの埋め込み - ビルド時にGitタグからバージョンを自動設定
- ビルド成果物へのREADMEとLICENSEファイルの同梱

### 変更

- Conventional Commits仕様への完全準拠 - より標準的なコミットメッセージ形式を採用
- エラーハンドリングの改善 - 外部コマンド実行時のエラーメッセージをより詳細に
- CI/CDワークフローの最適化 - golangci-lintのバージョン固定と設定の簡素化
- ドキュメントの更新 - miseの使用方法とConventional Commitsについての説明を追加
- コミット確認プロンプトの改善 - 選択肢を明確に表示し、編集オプションを追加

### 修正

- テストコードの構造改善 - AI実行とテストの責務分離を明確化

## [v1.1.0] - 2025-07-15

### 追加

- AIモデル選択機能を追加し、Claude以外にGeminiモデルも利用可能になりました
- ユニットテストの追加によりコードの品質保証を強化
- README.mdに使用方法の詳細説明とコマンド実行イメージを追加

### 変更

- 外部コマンド実行時のエラーハンドリングを改善し、より詳細なエラー情報を提供
- CI/CDワークフローを改善し、より効率的なビルドとテストプロセスを実現
- コードフォーマットを統一し、可読性を向上

## [v1.0.0] - 2025-07-13

### 追加

- gcauto CLIツールの初期リリース - Git操作を自動化するコマンドラインツール
- Claude AIとの統合によるインテリジェントなコミットメッセージ生成機能
- GitHub Actions CI/CDパイプラインの設定
- golangci-lintによる静的コード解析の導入
- miseタスクランナーによる開発環境の標準化
- MITライセンスの適用
- プロジェクトドキュメント（README）とコマンド実行イメージの提供

### 変更

- Claude AIへのプロンプト指示を改善し、より適切なコミットメッセージを生成
- CI設定とファイル形式を最適化
